<ion-content [fullscreen]="true" class="login-content">
  <!-- Botón de volver flotante -->
  <ion-fab vertical="top" horizontal="start" slot="fixed" class="back-fab">
    <ion-fab-button (click)="goBackToHome()" color="light" size="small">
      <ion-icon name="arrow-back"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <!-- Background decorativo -->
  <div class="background-shapes">
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
  </div>

  <!-- Logo y título -->
  <div class="logo-section">
    <div class="logo-container">
      <div class="logo-circle">
        <img  src="assets/logo.PNG" alt="AKI" class="header-logo">
      </div>
    </div>
    <p class="app-subtitle">Encuentra servicios cerca de ti</p>
  </div>

  <!-- Formulario principal -->
  <div class="form-container">
    <!-- Formulario único sin tabs -->
    <form #loginForm="ngForm" (ngSubmit)="onSubmit()" class="form">
      
      <!-- Nombre (solo en registro) -->
      <div class="form-group" *ngIf="!isLogin" [@slideIn]>
        <app-shared-input
          label="Nombre"
          icon="person-outline"
          placeholder="Nombre"
          name="name"
          [required]="true"
          [(ngModel)]="formData.name">
        </app-shared-input>
      </div>

      <!-- Apellido (solo en registro) -->
      <div class="form-group" *ngIf="!isLogin" [@slideIn]>
        <app-shared-input
          label="Apellido"
          icon="person-outline"
          placeholder="Apellido"
          name="lastname"
          [required]="true"
          [(ngModel)]="formData.lastname">
        </app-shared-input>
      </div>

      <!-- Teléfono (solo en registro) -->
      <div class="form-group" *ngIf="!isLogin" [@slideIn]>
        <app-shared-input
          label="Teléfono (opcional)"
          icon="call-outline"
          placeholder="Teléfono (opcional)"
          name="phone"
          type="tel"
          [(ngModel)]="formData.phone">
        </app-shared-input>
      </div>

      <!-- Email -->
      <div class="form-group">
        <app-shared-input
          label="Correo electrónico"
          icon="mail-outline"
          placeholder="Correo electrónico"
          type="email"
          name="email"
          [required]="true"
          [(ngModel)]="formData.email">
        </app-shared-input>
      </div>

      <!-- Contraseña -->
      <div class="form-group">
        <app-shared-input
          label="Contraseña"
          icon="lock-closed-outline"
          [type]="showPassword ? 'text' : 'password'"
          placeholder="Contraseña"
          name="password"
          [required]="true"
          [suffixIcon]="showPassword ? 'eye-off-outline' : 'eye-outline'"
          (suffixClick)="togglePassword()"
          [(ngModel)]="formData.password">
        </app-shared-input>
      </div>

      <!-- Confirmar contraseña (solo en registro) -->
      <div class="form-group" *ngIf="!isLogin" [@slideIn]>
        <app-shared-input
          label="Confirmar contraseña"
          icon="lock-closed-outline"
          [type]="showConfirmPassword ? 'text' : 'password'"
          placeholder="Confirmar contraseña"
          name="confirmPassword"
          [required]="true"
          [suffixIcon]="showConfirmPassword ? 'eye-off-outline' : 'eye-outline'"
          (suffixClick)="toggleConfirmPassword()"
          [(ngModel)]="formData.confirmPassword">
        </app-shared-input>
      </div>

      <!-- Aceptación de Términos (solo en registro) -->
      <div class="form-group legal-checkboxes" *ngIf="!isLogin" [@slideIn]>
        <ion-item class="checkbox-item">
          <ion-checkbox 
            [(ngModel)]="formData.acceptedTermsAndPrivacy" 
            name="acceptedTermsAndPrivacy"
            [required]="true"
            slot="start">
          </ion-checkbox>
          <ion-label class="checkbox-label">
            Acepto los 
            <a href="https://akicerca.app/terminos-condiciones" target="_blank" class="legal-link">
              Términos y Condiciones de Uso
            </a>
            y la 
            <a href="https://akicerca.app/politica-privacidad" target="_blank" class="legal-link">
              Política de Privacidad y Tratamiento de Datos
            </a>
            *
          </ion-label>
        </ion-item>
      </div>

      <!-- Botón principal -->
      <ion-button 
        expand="block" 
        type="submit"
        [disabled]="!loginForm.form.valid || isLoading || (!isLogin && !formData.acceptedTermsAndPrivacy)"
        class="submit-button">
        <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
        <span *ngIf="!isLoading">{{ isLogin ? 'Iniciar Sesión' : 'Crear Cuenta' }}</span>
      </ion-button>
    </form>

    <!-- Divider -->
    <div class="divider">
      <span>o</span>
    </div>

    <!-- Login con Google -->
    <ion-button 
      expand="block" 
      fill="outline"
      (click)="loginWithGoogle()"
      [disabled]="isLoading"
      class="google-button">
      <ion-icon name="logo-google" slot="start"></ion-icon>
      {{ isLogin ? 'Continuar con Google' : 'Registrarse con Google' }}
    </ion-button>

    <!-- Olvidé mi contraseña (solo en login) -->
    <div class="forgot-password" *ngIf="isLogin">
      <button type="button" (click)="forgotPassword()" class="forgot-link">
        ¿Olvidaste tu contraseña?
      </button>
    </div>
    <div class="footer">
      <p *ngIf="isLogin">
        ¿No tienes cuenta? 
        <button type="button" (click)="toggleMode()" class="link-button">Regístrate aquí</button>
      </p>
      <p *ngIf="!isLogin">
        ¿Ya tienes cuenta? 
        <button type="button" (click)="toggleMode()" class="link-button">Inicia sesión aquí</button>
      </p>
    </div>
  </div>

  <!-- Footer -->
  
</ion-content>